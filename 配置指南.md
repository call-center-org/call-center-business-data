# 📘 外呼坐席数据获取系统 - 配置指南

## 🎯 系统已自动完成配置！

根据您提供的API文档，所有API接口和参数已自动配置完成。您只需要3步即可开始使用。

---

## ✅ 3步快速上手

### 步骤1：填写您的认证信息

请选择以下**任一方式**填写认证信息：

#### 🔑 方式1：密钥认证（推荐）

打开项目后，在配置界面中：
1. 选择 **"密钥方式"**
2. 输入您的API密钥
3. 点击 **"获取Token"**

**如何获取密钥？**
1. 登录外呼平台
2. 访问 "用户设置" → "API密钥"
3. 点击 "生成密钥" 并保存
4. ⚠️ 密钥只显示一次，请妥善保管

#### 🔐 方式2：账号密码认证

在配置界面中：
1. 选择 **"账号密码"**
2. 输入用户名和密码
3. 点击 **"获取Token"**

---

### 步骤2：确认平台地址（已自动配置）

系统已默认配置为 **冠客平台**：
```
https://open-api.gooki.com
```

如果您使用**智语平台**，需要修改 `src/utils/apiConfig.js`：
```javascript
BASE_URL: 'https://api-open.zhizeliming.cn'
```

---

### 步骤3：开始使用

Token获取成功后：
1. 自动进入 **"呼出统计"** 页面
2. 选择统计天数（1/3/7/15/30天）
3. 点击 **"加载数据"**
4. 查看统计结果！

---

## 📊 已自动配置的功能

### ✅ API端点配置
| 功能 | 接口路径 | 状态 |
|------|---------|------|
| 获取Token（密钥） | `/token/secret` | ✅ 已配置 |
| 获取Token（账密） | `/token` | ✅ 已配置 |
| 获取呼出记录 | `/task/cdr/all2` | ✅ 已配置 |
| 获取任务列表 | `/task/list/v2` | ✅ 已配置 |
| 获取统计数据 | `/extension/agent/stat` | ✅ 已配置 |

### ✅ 字段映射配置
系统已自动映射所有话单字段：
- `callTime` - 拨打时间（时间戳）
- `duration` - 通话时长（秒）
- `TaskName` - 任务名称
- `deviceName` - 设备名称
- `grade` - 意向度/评级
- `hangupReason` - 挂机原因
- `phone` - 手机号
- 等30+字段...

### ✅ Token自动管理
- ✅ 自动获取Token
- ✅ 自动保存到本地
- ✅ 自动检测过期（30天有效期）
- ✅ 过期自动刷新
- ✅ 错误自动处理

---

## 🚀 启动项目

### 1. 安装依赖（首次使用）
```bash
cd /Users/tomnice/outbound-agent-data
npm install
```

### 2. 启动开发服务器
```bash
npm run dev
```

### 3. 打开浏览器
访问: **http://localhost:3001**

---

## 🎨 系统功能预览

### MVP核心功能
✅ **呼出统计**
- 总呼出量
- 成功呼出数
- 失败呼出数
- 日均呼出量
- 成功率计算
- 每日明细表

### 智能认证
✅ **Token配置界面**
- 支持密钥认证
- 支持账号密码认证
- 自动Token管理
- Token状态显示

### 数据展示
✅ **可视化界面**
- 现代化卡片设计
- 梯度配色
- 响应式布局
- 实时数据更新

---

## 🔧 配置文件说明

### 核心配置文件
1. **`src/utils/apiConfig.js`** - API配置
   - API基础URL
   - 认证配置
   - 端点配置
   - 字段映射

2. **`src/utils/tokenManager.js`** - Token管理
   - 自动获取Token
   - 自动刷新Token
   - LocalStorage缓存

3. **`src/utils/apiClient.js`** - HTTP客户端
   - 自动添加Token
   - 自动处理错误
   - 请求/响应拦截

4. **`src/utils/callApi.js`** - 业务API
   - 获取呼出记录
   - 统计计算
   - 数据处理

---

## 📋 使用流程

```
1. 首次打开系统
   ↓
2. 显示Token配置界面
   ↓
3. 选择认证方式（密钥 或 账号密码）
   ↓
4. 填写凭证信息
   ↓
5. 点击"获取Token"
   ↓
6. Token获取成功 ✅
   ↓
7. 自动跳转到呼出统计页面
   ↓
8. 选择统计天数
   ↓
9. 点击"加载数据"
   ↓
10. 查看统计结果 📊
```

---

## ⚠️ 注意事项

### 安全提示
- 🔒 Token存储在浏览器LocalStorage中
- 🔑 密钥只显示一次，请妥善保管
- ⏰ Token有效期30天，过期自动刷新
- 🚫 不要将密钥提交到代码仓库

### 常见问题
1. **Q: Token获取失败？**
   - A: 检查用户名/密码/密钥是否正确
   - A: 确认平台URL是否正确（冠客 vs 智语）

2. **Q: 数据加载失败？**
   - A: 打开浏览器控制台（F12）查看错误日志
   - A: 检查Token是否过期
   - A: 确认API接口是否可访问

3. **Q: 如何重新配置？**
   - A: 点击页面上的"退出登录"
   - A: 清除浏览器LocalStorage
   - A: 重新填写认证信息

---

## 📞 技术支持

### 查看日志
打开浏览器开发者工具（F12），查看Console标签：
- 📤 `API请求:` - 显示发送的请求
- 📥 `API响应:` - 显示接收的响应
- ✅ `Token获取成功` - Token获取状态
- ❌ 错误信息 - 详细的错误原因

### 文档参考
- `README.md` - 项目总览和快速开始
- `API_DOCUMENTATION.md` - API接口文档摘要
- `API_SETUP_GUIDE.md` - 详细配置指南

---

## 🎉 开始使用

现在您已经了解了所有配置细节，让我们开始吧！

```bash
# 1. 确保在项目目录
cd /Users/tomnice/outbound-agent-data

# 2. 如果还没安装依赖
npm install

# 3. 启动项目
npm run dev

# 4. 打开浏览器
# 访问: http://localhost:3001
```

祝您使用愉快！ 🚀

